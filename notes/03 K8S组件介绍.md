# 03 K8S组件介绍

## 核心组件

### 配置存储中心——ETCD

存储集群的元数据信息。

### 主控（master）节点

* kube-apiserver服务（大脑）
    * 提供了集群管理的REST API接口（包括鉴权、数据校验及集群状态变更）
    * 负责其他模块之间的数据交互，承担通信枢纽功能
    * 是资源配额控制的入口
    * 提供完备的集群安全机制

* kube-controller-manager服务
    * 由一系列控制器组成，通过apiserver监控集群的状态，并确保集群处于预期的工作状态
    * Node Controller
    * Deployment Controller
    * Service Controller
    * Volume Controller
    * Endpoint Controller
    * Garbage Controller
    * Namespace Controller
    * Job Controller
    * ......

* kube-scheduler服务
    * 接收调度pod到适合的运算节点上
    * 预算策略（predict）
    * 优选策略（priorities）

### 运算（node）节点

* kube-kubelet服务
    * 定时从某个地方获取节点上pod的期望状态（运行的容器、副本数、网络或存储如何配置等），并调用对应的容器平台接口达到这个状态
    * 定时汇报当前节点的状态给apiserver，以供调度的时候使用
    * 镜像和容器的清理工作，保证节点上镜像不会粘满磁盘空间，退出的容器不会占用太多资源

* kube-proxy服务（虚拟网络）
    * 是K8S在每个节点上运行网络代理，service资源的载体
    * 建立了pod网络和集群网络的关系（cluster ip --> pod ip）
    * 常用三种流量调度模式
        * Userspace（废弃）
        * Iptables（濒临废弃）
        * Ipvs（推荐）
    * 负责建立和删除包括更新调度规则、通知apiserver自己的更新，或者从apiserver那里获取其他kube-proxy的调度规则变化来更新自己的。



## CLI客户端

* kubectl



## 核心附件

* CNI网络插件：flannel/calico
* 服务发现用插件：coredns

* 服务暴露用插件：traefik
* GUI管理插件：Dashboard